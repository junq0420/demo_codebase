# --------------------------------------------
# 基本变量
# --------------------------------------------
TARGET      := run_app
SRCS        := $(wildcard *.c)
OBJS        := $(SRCS:.c=.o)
DEPS        := $(SRCS:.c=.d)

# 根据需要可改成 clang / arm-none-eabi-gcc 等
CC          := gcc
CFLAGS      := -Wall -Wextra -std=c99 -O2 -MMD -MP
LDFLAGS     :=

# --------------------------------------------
# 默认目标：生成可执行文件
# --------------------------------------------
.PHONY: all clean
all: $(TARGET)

$(TARGET): $(OBJS)
	$(CC) $(LDFLAGS) -o $@ $^

# --------------------------------------------
# 自动生成依赖
# --------------------------------------------
-include $(DEPS)

# --------------------------------------------
# 通用规则：.c -> .o
# --------------------------------------------
%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

# --------------------------------------------
# 清理
# --------------------------------------------
clean:
	rm -f $(OBJS) $(DEPS) $(TARGET)
